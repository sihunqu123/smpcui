<div class="content-selection">
  <form [formGroup]="formData">
    <ng-template matStepLabel>选择要发布的内容</ng-template>
    <div class="content-seletion-body">
    </div>
    <!-- hide the search feather, since the backend API doesn't support this yet. -->
    <mat-form-field class="content-search-form-field" appearance="fill" style="display: none">
      <mat-label>请至少输入2个字来搜索内容</mat-label>
      <input matInput type="text" [(ngModel)]="paginateArg.queryTxt" (keyup)="onSearchTxtChange($event)" [ngModelOptions]="{standalone: true}">
      <button *ngIf="paginateArg.queryTxt" matSuffix mat-icon-button aria-label="Clear" (click)="paginateArg.queryTxt=''">
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>

    <div class="smpshare-content-actions">
      <button mat-raised-button color="accent" (click)="previewContents(selection.selected)" [disabled]="!selection.selected.length" >{{ btnTxt }}</button>
      <!--
      <button mat-raised-button color="accent" (click)="addSelection(selection.selected)" [disabled]="!selection.selected.length" >添加至分享列表</button>
      -->
    </div>

    <div class="mat-elevation-z8 content-list" *ngIf="dataSourceSearch?.data?.length">
      <table mat-table #tableSearch [dataSource]="dataSourceSearch" matSort
        #sortSearch="matSort"
        (matSortChange)="changeSort($event)"
        matSortActive="updated" matSortDirection="desc"
        matSortDisableClear>
        <!-- Checkbox Column -->
        <ng-container matColumnDef="select">
          <th mat-header-cell *matHeaderCellDef>
            <mat-checkbox (change)="$event ? masterToggle() : null"
                          [checked]="selection.hasValue() && isAllSelected()"
                          [indeterminate]="selection.hasValue() && !isAllSelected()"
                          [aria-label]="checkboxLabel()">
            </mat-checkbox>
          </th>
          <td mat-cell *matCellDef="let row">
            <mat-checkbox (click)="$event.stopPropagation()"
                          (change)="$event ? selection.toggle(row) : null"
                          [checked]="selection.isSelected(row)"
                          [disabled]="row.disabled"
                          [aria-label]="checkboxLabel(row)"
            >
            </mat-checkbox>
          </td>
        </ng-container>

        <!-- title Column -->
        <ng-container matColumnDef="title">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> 标题 </th>
          <td mat-cell *matCellDef="let element" title="{{element.title}}"> {{element.title}} </td>
        </ng-container>

        <!-- Name Column -->
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> 名称 </th>
          <td mat-cell *matCellDef="let element" title="{{element.name}}"> {{element.name}} </td>
        </ng-container>

        <!-- lastModified Column -->
        <ng-container matColumnDef="updated">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> 修改时间 </th>
          <td mat-cell *matCellDef="let element" title="{{element.updated}}"> {{element.updated}} </td>
        </ng-container>

        <ng-container matColumnDef="preview">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> 操作</th>
          <td mat-cell *matCellDef="let element" title="preview">
            <button mat-raised-button color="accent" (click)="previewContents([element])" >{{ btnTxt }}</button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumnsSearch"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumnsSearch;"
          [class.row-disabled]="row.disabled"
          ></tr>
      </table>
      <!--
        TODO: pagination for async
      -->
      <mat-paginator
        #paginator4Table
        [length]="paginateArg.total"
        [pageIndex]="paginateArg.page"
        [pageSize]="paginateArg.pagesize"
        [pageSizeOptions]="[5, 10, 20]"
        (page)="pageChange($event)"
        showFirstLastButtons></mat-paginator>
    </div>

  </form>
</div>
